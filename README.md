# SecureEye
SecureEye is an advanced AI-powered tool for secure source code review. It conducts a thorough assessment of provided code to identify potential vulnerabilities and risks, evaluating for common attack vectors such as SQL injection, XSS, buffer overflow, and remote code execution. SecureEye analyzes the code for secure coding practices, including input validation, output sanitization, authentication and access controls, and error handling. Based on its findings, SecureEye provides detailed recommendations for improving the code's security posture and mitigating any risks found. The tool may suggest changes to code architecture, libraries, and frameworks. SecureEye's comprehensive report includes a detailed description of each vulnerability found, its severity, and a snippet of affected code. The report also includes a walkthrough of the mitigation steps taken and a snippet of the updated, mitigated code, helping to ensure the application's security and integrity while minimizing the risk of future security incidents.

### Report sample generated by SecureEye [Report](report/report.md)

### Create virtualenv
```bash
virtualenv secureEye 
. secureEye/bin/activate
```
### Install dependencies
```bash
python3 -m pip install requirements.txt
```
### Replace github link for code to be analyzed in file gitCode.py
```bash
repo_url = f"https://github.com/username/to-be-analyzed.git"
```
### Run
```bash
python3 main.py
```
### OutPut

Upon examining the provided code, I have identified the following security concern:

Vulnerability Type: Unvalidated Input

Vulnerability Description: The 'username' parameter is passed through GET request without being validated or sanitized before being included in the `$links` array. This may allow an attacker to inject malicious input, potentially leading to security issues such as XSS or SQLi attacks.

Severity: Medium

A snippet of affected code:
```
'User Filter' => '/index.php?username=jared',
```

Mitigation walkthrough: All user input should be considered potentially harmful and should thus be sanitized appropriately. In this case, the 'username' parameter should be validated and sanitized before being used in the `$links` array. One effective way of mitigating this vulnerability is to use the `filter_input()` function to sanitize the input parameter. For example:
```
$username = filter_input(INPUT_GET, 'username', FILTER_SANITIZE_STRING);
```

A snippet of mitigated code:
```
$raw_username = 'jared';
$username = filter_var($raw_username, FILTER_SANITIZE_STRING);
$links = array(
                'User Filter' => '/index.php?username=' . $username,
                'Login' => '/login.php', 
                'Send Message' => '/sendmessage.php', 
                'View Messages' => '/messages.php', 
                'Edit Profile' => '/editprofile.php',
                'Load Template' => '/template.php?load=loadme'
          );
```

This code filters $_GET['username'] and apply a filter to validate that it is a string. The sanitized result is then assigned to $username which is subsequently used in the `$links` array. This makes sure that any malicious input to the `username` parameter will be sanitized and cannot be used to execute a successful attack.
821
Reading file's content: consts.php
Detecting file's content encoding: ascii
Removing comments from the file contents: consts.php
Splitting messages into smaller chunks of at most 1000 tokens
Analyzing consts.php chunk #1
Vulnerability Type: Hardcoded Credentials
Vulnerability Description: The database credentials are hardcoded in the code.
Severity: High
A snippet of affected code:
```
define("DB_HOST", "localhost");
define("DB_USER", "changeme");
define("DB_PASS", "changeme");
define("DB_DB","sydphp");
```
Mitigation walkthrough: 
Update the code to retrieve the database credentials from a secure configuration source, such as an environment variable or a configuration file outside of the code repository. This will prevent the credentials from being exposed in the code and reduce the risk of unauthorized access to the database. 
A snippet of mitigated code: 
```
$db_host = getenv("DB_HOST");
$db_user = getenv("DB_USER");
$db_pass = getenv("DB_PASS");
$db_name = getenv("DB_NAME");

$link = mysqli_connect($db_host, $db_user, $db_pass, $db_name);

```
![image](https://user-images.githubusercontent.com/51442494/230654799-691528ac-8cc4-4032-b753-90d1152661de.png)
